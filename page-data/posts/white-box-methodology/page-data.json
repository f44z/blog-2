{"componentChunkName":"component---src-templates-post-template-post-template-tsx","path":"/posts/white-box-methodology","result":{"data":{"markdownRemark":{"id":"1a7d851d-2e8c-5cda-aec9-d0a44f895cca","html":"<p>Recently, I finished the Offensive Security WEB-300 course and successfully passed OSWE certification. The goal of this article is to share the methodology I’m using in white box engagements and which helped me in 48h long OSWE exam.</p>\n<p>Before diving into the methodology, it’s worth spearing some words about the course and exam itself. The Offensive Security WEB-300 course is all about white box web testing, so application source code is available. It means exposure to a lot of code in five different languages: Java, JavaScript, C#, Python, PHP. The full course syllabus can be found <a href=\"https://www.offensive-security.com/documentation/awae-syllabus.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">here</a>.</p>\n<p>In my opinion, you have to obtain four types of skills to become OSWE:</p>\n<ol>\n<li>Understanding the syntax of many languages and their web frameworks to efficiently analyze big codebases.</li>\n<li>Knowledge of web vulnerabilities - how to discover and exploit them.</li>\n<li>Scripting skills - know how to pack a kill chain of vulnerabilities in one script in the language of your choice (WEB-300 course uses python).</li>\n<li>Having a solid white box testing methodology.</li>\n</ol>\n<p>Resources that I used for learning about 1 and 2 are linked at the <a href=\"#resources\">end of this article</a>.</p>\n<h2 id=\"white-box-methodology\" style=\"position:relative;\"><a href=\"#white-box-methodology\" aria-label=\"white box methodology permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>White box methodology</h2>\n<ul>\n<li><a href=\"#white-box-methodology\">White box methodology</a></li>\n<li><a href=\"#reconnaissance\">Reconnaissance</a></li>\n<li><a href=\"#threat-modeling\">Threat modeling</a></li>\n<li><a href=\"#tests-preparation\">Tests preparation</a></li>\n<li><a href=\"#understand-the-application\">Understand the application</a></li>\n<li><a href=\"#automatic-scans\">Automatic scans</a></li>\n<li><a href=\"#manual-code-review\">Manual code review</a></li>\n<li><a href=\"#resources\">Resources</a></li>\n</ul>\n<h2 id=\"reconnaissance\" style=\"position:relative;\"><a href=\"#reconnaissance\" aria-label=\"reconnaissance permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Reconnaissance</h2>\n<p>This step is all about a clicking-through application from a user perspective with Burp proxy (or similar tool) turned on. Note all of the application functionalities, technology, how it handles authentication, authorization, is there anything odd that triggers your pentesting instinct? It’s worth to pay attention to the structure of requests, cookies, local storage. Writiting down observation from this step is essential.</p>\n<h2 id=\"threat-modeling\" style=\"position:relative;\"><a href=\"#threat-modeling\" aria-label=\"threat modeling permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Threat modeling</h2>\n<p>It’s time to make use of your notes from the reconnaissance phase. List all of the application functionalities and map this to known vulnerabilities. What can go wrong if the attacker misuses the presented functionality? There are threat modeling lessons that I find very useful, it’s from Jakub Kaluzny from SecuRing - you can watch it <a href=\"https://www.youtube.com/watch?v=e_haUCYppYs&#x26;list=PL-lO2xrptAtav4SZgCdDkVxChWhVU3kmP\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">here</a>.</p>\n<h2 id=\"tests-preparation\" style=\"position:relative;\"><a href=\"#tests-preparation\" aria-label=\"tests preparation permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tests preparation</h2>\n<p>In this step, you should prepare a code base for tests. This depends on the type of application that you are auditing, but in general:</p>\n<ol>\n<li>Turn on the application, database, and system logging policy to the most detailed (like debug) and find a place where logs are stored.</li>\n<li>Set up the environment for application debugging. It’s very handy to work with a debugger instead of a console.logging/printing messages.</li>\n<li>Sometimes it’s also useful to observe interactions between application and system in. ex. <a href=\"https://docs.microsoft.com/en-us/sysinternals/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">windows sysinternals</a> Procmon and ProcessHacker can become handy.</li>\n</ol>\n<h2 id=\"understand-the-application\" style=\"position:relative;\"><a href=\"#understand-the-application\" aria-label=\"understand the application permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Understand the application</h2>\n<p>Before starting to look for vulnerabilities, it’s worth to know how the application is structured and understand used coding patterns. It can become easier if the application is based on some framework or uses well-known architecture like MVP. All exceptions from standards like places where database query is done without ORM or parts of the application that use custom code instead of framework capabilities, could be helpful in vulnerability search. Using debugger can make this step easier.</p>\n<p>In this phase I’m trying to answer the following questions:</p>\n<ul>\n<li>What framework application uses?</li>\n<li>How routing works?</li>\n<li>How requests with user input are handled?</li>\n<li>Where is the application configuration located?</li>\n<li>How session is handled?</li>\n<li>How it interacts with a database?</li>\n<li>How it handles authorization?</li>\n<li>How it handles authentication?</li>\n</ul>\n<h2 id=\"automatic-scans\" style=\"position:relative;\"><a href=\"#automatic-scans\" aria-label=\"automatic scans permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Automatic scans</h2>\n<p><strong>Warning. You can’t use automatic scanners in OSWE exam</strong> but it becomes really handy in real-life engagements, to localize low-hanging fruits. I have a local lab with three tools:</p>\n<ul>\n<li><a href=\"https://www.sonarqube.org/downloads/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">SonarQube Community</a> for static code analysis</li>\n<li><a href=\"https://owasp.org/www-project-dependency-check/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OWASP Dependency check</a> for finding vulnerabilities in application dependencies</li>\n<li><a href=\"https://portswigger.net/burp/pro\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Burp Professional</a> for application dynamic analysis utilizing scanner module</li>\n</ul>\n<h2 id=\"manual-code-review\" style=\"position:relative;\"><a href=\"#manual-code-review\" aria-label=\"manual code review permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Manual code review</h2>\n<p>and real fun starts now. To summarize, following data is gathered from previous enumeration steps:</p>\n<ul>\n<li>basic knowledge of the application and its functionalities,</li>\n<li>threat model,</li>\n<li>insight into how the application is structured and how it works,</li>\n<li>low-hanging fruits from the automatic analysis.</li>\n</ul>\n<p>The OffSec exam and CTF’s are different from the real-life scenario. Usually, in real engagement, you should stick to penetration testing methodologies like <a href=\"https://owasp.org/www-project-web-security-testing-guide/assets/archive/OWASP_Testing_Guide_v4.pdf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">OWASP Testing Guide</a> to make sure your tests for all well-known vulnerabilities and deliver a comprehensive report.</p>\n<p>In CTF the goal is usually to get full control over the application and underlying system. Firstly, look for some kind of authentication bypass as in general it’s easier to find more serious vulnerabilities like RCE as admin user than as non-logged in. When looking for authentication bypass, focus on all application functionalities related to login and registering user, such as:</p>\n<ul>\n<li>simple logic flaws related to login in. ex. possibility to register as a user with the highest privileges</li>\n<li>password reset</li>\n<li>try bruteforcing login panel - pay attention to account blocking mechanisms</li>\n<li>weak crypto related to session handling</li>\n<li>SQL injection vulnerabilities, to extract password hashes or plaintext passwords from DB</li>\n<li>how an application is protected against XSS, maybe it’s possible to hijack admin sessions using XSS-based vulnerability?</li>\n</ul>\n<p>Having access to the application as a privileged user, you can utilize all of its functionalities to get RCE or find flags. Things like insecure deserialization flaws, unrestricted file upload vulnerabilities, or SQL injections could be an important ingredient in your RCE kill chain recipe.</p>\n<p>Have you find is useful? Do you have other white box testing flow? Please find me <a href=\"https://www.twitter.com/meltedblocks\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">@twitter</a> and discuss.</p>\n<p>Happy hacking!</p>\n<h2 id=\"resources\" style=\"position:relative;\"><a href=\"#resources\" aria-label=\"resources permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resources</h2>\n<ul>\n<li>web application vulnerability refresher - <a href=\"https://portswigger.net/web-security\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PortSwigger Academy</a></li>\n<li>javascript for pentesters in <a href=\"https://www.pentesteracademy.com/course?id=11\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Pentester Academy</a></li>\n<li>burp refresher from <a href=\"https://www.youtube.com/watch?v=h2duGBZLEek\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Bugcrowd University</a></li>\n<li>resource mentioned in <a href=\"https://github.com/wetw0rk/AWAE-PREP\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">wetw0rk github repo</a></li>\n<li>security code review series from <a href=\"https://medium.com/@paul_io/security-code-review-101-a3c593dc6854\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Paul Ionescu</a></li>\n<li><a href=\"https://hub.schellman.com/blog/oswe-review-and-exam-preparation-guide\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Nathan Rague OSWE Review and Exam Preperation Guide</a></li>\n</ul>","fields":{"slug":"/posts/white-box-methodology","tagSlugs":["/tag/pentesting/"]},"frontmatter":{"date":"2021-03-21T08:40:32.169Z","description":"Recently, I finished the Offensive Security WEB-300 course and successfully passed OSWE certification. The goal of this article is to share the methodology I'm using in white box engagements and which helped me in 48h long OSWE exam.","tags":["Pentesting"],"title":"Web application white box pentesting methodology","socialImage":"/media/oswe-badge.png"}}},"pageContext":{"slug":"/posts/white-box-methodology"}},"staticQueryHashes":["251939775","357378587","401334301"]}